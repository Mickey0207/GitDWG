# GitDWG 版本回復功能使用指南

## ?? 新功能發布
GitDWG現在支援完整的版本回復功能！您可以安全地回復到任何歷史版本。

## ?? 功能位置
在主界面右側的「版本操作」區域，您會看到三個按鈕：
1. **比較版本** - 比較選擇的提交與前一版本
2. **安全回復** - ?? 創建新提交來撤銷變更（推薦）
3. **重置版本** - ?? 危險操作：刪除提交歷史

## ?? 使用方式

### 步驟1: 選擇目標版本
1. 在「提交歷史」列表中瀏覽所有提交記錄
2. 點擊您想要回復的版本（會以藍色標示選中）
3. 確認選擇的版本資訊正確

### 步驟2: 選擇回復方式

#### ?? 安全回復（推薦）
**使用時機**: 大部分情況下都建議使用此選項
**操作**: 點擊「安全回復」按鈕

**特點**:
- ? 保留所有提交歷史
- ? 創建新的提交來撤銷變更
- ? 可以再次回復（可逆操作）
- ? 團隊協作安全

**流程**:
1. 系統會顯示確認對話框，包含：
   - 目標版本的詳細資訊
   - 操作說明和影響範圍
2. 確認後系統會：
   - 分析需要撤銷的變更
   - 創建一個新的提交來回復變更
   - 保留完整的提交歷史

#### ?? 重置版本（危險操作）
**使用時機**: 僅在確定要永久刪除歷史時使用
**操作**: 點擊「重置版本」按鈕

**警告**:
- ?? 永久刪除指定版本之後的所有提交
- ?? 不可逆操作！
- ?? 可能影響團隊協作

**安全確認**:
1. 第一次確認：顯示詳細警告訊息
2. 第二次確認：需要輸入 "CONFIRM" 才能執行
3. 執行後無法復原

## ?? 實際使用示例

### 示例1: 回復CAD圖面到昨天的版本
```
場景：今天的修改有問題，想回復到昨天的版本

1. 在提交歷史中找到昨天的提交
2. 點擊選擇該提交
3. 點擊「安全回復」
4. 確認回復操作
5. GitDWG會創建新提交，檔案回復到昨天的狀態
```

### 示例2: 比較兩個版本的差異
```
場景：想看看昨天和今天的圖面有什麼不同

1. 選擇今天的提交
2. 點擊「比較版本」
3. AutoCAD會開啟兩個版本的圖面
4. 可以直接在AutoCAD中比較差異
```

## ??? 安全最佳實踐

### 回復前的準備
1. **確認當前狀態**: 確保沒有未保存的工作
2. **關閉AutoCAD**: 避免檔案鎖定問題
3. **備份重要檔案**: 雖然安全回復是可逆的，但備份總是好習慣
4. **通知團隊**: 如果是共享儲存庫，提前通知團隊成員

### 選擇回復方式的建議
- ?? **99%的情況使用「安全回復」**
- ?? **僅在個人儲存庫且確定需要清理歷史時使用「重置版本」**
- ?? **絕不在共享團隊儲存庫中使用「重置版本」**

## ?? 常見問題與解決

### 問題1: 回復後檔案沒有變化
**原因**: 可能選擇的版本與當前版本相同
**解決**: 
1. 檢查是否選擇了正確的歷史版本
2. 使用「強制重新整理」更新狀態

### 問題2: 回復時提示衝突
**原因**: 回復操作與當前變更有衝突
**解決**:
1. 先提交或暫存當前變更
2. 確保工作目錄乾淨
3. 再執行回復操作

### 問題3: AutoCAD檔案被鎖定
**原因**: AutoCAD正在使用檔案
**解決**:
1. 關閉AutoCAD
2. 點擊「強制重新整理」
3. 再執行回復操作

### 問題4: 意外使用了重置版本
**解決**: 如果剛執行完且還記得被刪除的提交SHA：
1. 可以嘗試使用Git指令恢復：`git reflog`
2. 找到被刪除的提交
3. 使用`git reset --hard <commit-sha>`恢復

## ?? 進階技巧

### 技巧1: 部分檔案回復
如果只想回復特定檔案：
1. 使用「比較版本」找到目標檔案
2. 手動從AutoCAD複製需要的內容
3. 做為新的提交

### 技巧2: 批量回復多個版本
如果需要回復多個連續的提交：
1. 選擇最早需要回復的版本
2. 使用「安全回復」
3. 會一次性撤銷到該版本的所有變更

### 技巧3: 預覽回復效果
在確認回復前：
1. 使用「比較版本」預覽變更
2. 確認這就是想要的結果
3. 再執行實際回復

## ?? 功能對比表

| 功能 | 安全回復 | 重置版本 | 比較版本 |
|------|----------|----------|----------|
| 保留歷史 | ? | ? | N/A |
| 可逆操作 | ? | ? | N/A |
| 團隊安全 | ? | ? | ? |
| 速度 | 一般 | 快 | 快 |
| 風險等級 | 低 | 高 | 無 |
| 推薦使用 | ? | 謹慎 | ? |

## ?? 與其他功能的整合

### 與圖面比較功能整合
- 回復前可以先使用比較功能預覽變更
- 回復後可以比較回復前後的差異

### 與提交功能整合
- 回復會自動創建新的提交（安全回復模式）
- 回復後的狀態會顯示在提交歷史中

### 與分支功能整合
- 回復操作會影響當前分支
- 可以考慮在新分支上進行實驗性回復

---

**新功能狀態**: ? 已完成並可使用
**安全等級**: ?? 高（安全回復模式）
**建議使用場景**: CAD圖面版本管理、錯誤修改回復、歷史版本恢復